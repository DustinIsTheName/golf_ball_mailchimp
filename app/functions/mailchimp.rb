class Mailchimp
  def self.replenishment_email(order = nil)
    puts Colorize.green("replenishment_email")

    ##############
    # Create list
    ##############

    unless order
      # params = {"id"=>820982911946154508, "email"=>"dustin@wittycreative.com", "closed_at"=>nil, "created_at"=>"2019-03-25T15:21:47-04:00", "updated_at"=>"2019-03-25T15:21:47-04:00", "number"=>234, "note"=>nil, "token"=>"123456abcd", "gateway"=>nil, "test"=>true, "total_price"=>"70.94", "subtotal_price"=>"60.94", "total_weight"=>0, "total_tax"=>"0.00", "taxes_included"=>false, "currency"=>"USD", "financial_status"=>"voided", "confirmed"=>false, "total_discounts"=>"5.00", "total_line_items_price"=>"65.94", "cart_token"=>nil, "buyer_accepts_marketing"=>true, "name"=>"#9999", "referring_site"=>nil, "landing_site"=>nil, "cancelled_at"=>"2019-03-25T15:21:47-04:00", "cancel_reason"=>"customer", "total_price_usd"=>nil, "checkout_token"=>nil, "reference"=>nil, "user_id"=>nil, "location_id"=>nil, "source_identifier"=>nil, "source_url"=>nil, "processed_at"=>nil, "device_id"=>nil, "phone"=>nil, "customer_locale"=>"en", "app_id"=>nil, "browser_ip"=>nil, "landing_site_ref"=>nil, "order_number"=>1234, "discount_applications"=>[{"type"=>"manual", "value"=>"5.0", "value_type"=>"fixed_amount", "allocation_method"=>"one", "target_selection"=>"explicit", "target_type"=>"line_item", "description"=>"Discount", "title"=>"Discount"}], "discount_codes"=>[], "note_attributes"=>[], "payment_gateway_names"=>["visa", "bogus"], "processing_method"=>"", "checkout_id"=>nil, "source_name"=>"web", "fulfillment_status"=>"pending", "tax_lines"=>[], "tags"=>"", "contact_email"=>"jon@doe.ca", "order_status_url"=>"https://checkout.shopify.com/17004443/orders/123456abcd/authenticate?key=abcdefg", "presentment_currency"=>"USD", "total_line_items_price_set"=>{"shop_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}}, "total_discounts_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "total_shipping_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "subtotal_price_set"=>{"shop_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}}, "total_price_set"=>{"shop_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}}, "total_tax_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "total_tip_received"=>"0.0", "line_items"=>[{"id"=>866550311766439020, "variant_id"=>nil, "title"=>"Practice B-Range Golf Balls - 300 Count", "quantity"=>1, "price"=>"59.95", "sku"=>"CAS-MIX-BRANGE-REC-300-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1377072644139, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"Practice B-Range Golf Balls - 300 Count", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>14969, "total_discount"=>"0.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}], "shipping_lines"=>[{"id"=>271878346596884015, "title"=>"Generic Shipping", "price"=>"10.00", "code"=>nil, "source"=>"shopify", "phone"=>nil, "requested_fulfillment_service_id"=>nil, "delivery_category"=>nil, "carrier_identifier"=>nil, "discounted_price"=>"10.00", "price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discounted_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}], "billing_address"=>{"first_name"=>"Bob", "address1"=>"123 Billing Street", "phone"=>"555-555-BILL", "city"=>"Billtown", "zip"=>"K2P0B0", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Biller", "address2"=>nil, "company"=>"My Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Bob Biller", "country_code"=>"US", "province_code"=>"KY"}, "shipping_address"=>{"first_name"=>"Steve", "address1"=>"123 Shipping Street", "phone"=>"555-555-SHIP", "city"=>"Shippington", "zip"=>"40003", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Shipper", "address2"=>nil, "company"=>"Shipping Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Steve Shipper", "country_code"=>"US", "province_code"=>"KY"}, "fulfillments"=>[], "refunds"=>[], "customer"=>{"id"=>115310627314723954, "email"=>"john@test.com", "accepts_marketing"=>false, "created_at"=>nil, "updated_at"=>nil, "first_name"=>"John", "last_name"=>"Smith", "orders_count"=>0, "state"=>"disabled", "total_spent"=>"0.00", "last_order_id"=>nil, "note"=>nil, "verified_email"=>true, "multipass_identifier"=>nil, "tax_exempt"=>false, "phone"=>nil, "tags"=>"", "last_order_name"=>nil, "currency"=>"USD", "accepts_marketing_updated_at"=>nil, "marketing_opt_in_level"=>nil, "default_address"=>{"id"=>715243470612851245, "customer_id"=>115310627314723954, "first_name"=>nil, "last_name"=>nil, "company"=>nil, "address1"=>"123 Elm St.", "address2"=>nil, "city"=>"Ottawa", "province"=>"Ontario", "country"=>"Canada", "zip"=>"K2H7A8", "phone"=>"123-123-1234", "name"=>"", "province_code"=>"ON", "country_code"=>"CA", "country_name"=>"Canada", "default"=>true}}, "controller"=>"email", "action"=>"save_order"}

      # params = {"id"=>820982911946154508, "email"=>"dustin@wittycreative.com", "closed_at"=>nil, "created_at"=>"2019-03-25T15:21:47-04:00", "updated_at"=>"2019-03-25T15:21:47-04:00", "number"=>234, "note"=>nil, "token"=>"123456abcd", "gateway"=>nil, "test"=>true, "total_price"=>"70.94", "subtotal_price"=>"60.94", "total_weight"=>0, "total_tax"=>"0.00", "taxes_included"=>false, "currency"=>"USD", "financial_status"=>"voided", "confirmed"=>false, "total_discounts"=>"5.00", "total_line_items_price"=>"65.94", "cart_token"=>nil, "buyer_accepts_marketing"=>true, "name"=>"#9999", "referring_site"=>nil, "landing_site"=>nil, "cancelled_at"=>"2019-03-25T15:21:47-04:00", "cancel_reason"=>"customer", "total_price_usd"=>nil, "checkout_token"=>nil, "reference"=>nil, "user_id"=>nil, "location_id"=>nil, "source_identifier"=>nil, "source_url"=>nil, "processed_at"=>nil, "device_id"=>nil, "phone"=>nil, "customer_locale"=>"en", "app_id"=>nil, "browser_ip"=>nil, "landing_site_ref"=>nil, "order_number"=>1234, "discount_applications"=>[{"type"=>"manual", "value"=>"5.0", "value_type"=>"fixed_amount", "allocation_method"=>"one", "target_selection"=>"explicit", "target_type"=>"line_item", "description"=>"Discount", "title"=>"Discount"}], "discount_codes"=>[], "note_attributes"=>[], "payment_gateway_names"=>["visa", "bogus"], "processing_method"=>"", "checkout_id"=>nil, "source_name"=>"web", "fulfillment_status"=>"pending", "tax_lines"=>[], "tags"=>"", "contact_email"=>"jon@doe.ca", "order_status_url"=>"https://checkout.shopify.com/17004443/orders/123456abcd/authenticate?key=abcdefg", "presentment_currency"=>"USD", "total_line_items_price_set"=>{"shop_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}}, "total_discounts_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "total_shipping_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "subtotal_price_set"=>{"shop_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}}, "total_price_set"=>{"shop_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}}, "total_tax_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "total_tip_received"=>"0.0", "line_items"=>[{"id"=>866550311766439020, "variant_id"=>nil, "title"=>"Practice B-Range Golf Balls - 300 Count", "quantity"=>1, "price"=>"59.95", "sku"=>"CAS-MIX-BRANGE-REC-300-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1377072644139, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"Practice B-Range Golf Balls - 300 Count", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>14969, "total_discount"=>"0.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}, {"id"=>141249953214522974, "variant_id"=>nil, "title"=>"5 Martini 3 1/4\" Golf Tees", "quantity"=>1, "price"=>"5.99", "sku"=>"CAS-MAR-314-PURPLE-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1680824926254, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"5 Martini 3 1/4\" Golf Tees", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>227, "total_discount"=>"5.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "discount_allocations"=>[{"amount"=>"5.00", "discount_application_index"=>0, "amount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}}], "tax_lines"=>[]}], "shipping_lines"=>[{"id"=>271878346596884015, "title"=>"Generic Shipping", "price"=>"10.00", "code"=>nil, "source"=>"shopify", "phone"=>nil, "requested_fulfillment_service_id"=>nil, "delivery_category"=>nil, "carrier_identifier"=>nil, "discounted_price"=>"10.00", "price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discounted_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}], "billing_address"=>{"first_name"=>"Bob", "address1"=>"123 Billing Street", "phone"=>"555-555-BILL", "city"=>"Billtown", "zip"=>"K2P0B0", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Biller", "address2"=>nil, "company"=>"My Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Bob Biller", "country_code"=>"US", "province_code"=>"KY"}, "shipping_address"=>{"first_name"=>"Steve", "address1"=>"123 Shipping Street", "phone"=>"555-555-SHIP", "city"=>"Shippington", "zip"=>"40003", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Shipper", "address2"=>nil, "company"=>"Shipping Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Steve Shipper", "country_code"=>"US", "province_code"=>"KY"}, "fulfillments"=>[], "refunds"=>[], "customer"=>{"id"=>115310627314723954, "email"=>"john@test.com", "accepts_marketing"=>false, "created_at"=>nil, "updated_at"=>nil, "first_name"=>"John", "last_name"=>"Smith", "orders_count"=>0, "state"=>"disabled", "total_spent"=>"0.00", "last_order_id"=>nil, "note"=>nil, "verified_email"=>true, "multipass_identifier"=>nil, "tax_exempt"=>false, "phone"=>nil, "tags"=>"", "last_order_name"=>nil, "currency"=>"USD", "accepts_marketing_updated_at"=>nil, "marketing_opt_in_level"=>nil, "default_address"=>{"id"=>715243470612851245, "customer_id"=>115310627314723954, "first_name"=>nil, "last_name"=>nil, "company"=>nil, "address1"=>"123 Elm St.", "address2"=>nil, "city"=>"Ottawa", "province"=>"Ontario", "country"=>"Canada", "zip"=>"K2H7A8", "phone"=>"123-123-1234", "name"=>"", "province_code"=>"ON", "country_code"=>"CA", "country_name"=>"Canada", "default"=>true}}, "controller"=>"email", "action"=>"save_order"}
      # params = {"id"=>820982911946154508, "email"=>"dustin@wittycreative.com", "closed_at"=>nil, "created_at"=>"2019-03-25T15:21:47-04:00", "updated_at"=>"2019-03-25T15:21:47-04:00", "number"=>234, "note"=>nil, "token"=>"123456abcd", "gateway"=>nil, "test"=>true, "total_price"=>"70.94", "subtotal_price"=>"60.94", "total_weight"=>0, "total_tax"=>"0.00", "taxes_included"=>false, "currency"=>"USD", "financial_status"=>"voided", "confirmed"=>false, "total_discounts"=>"5.00", "total_line_items_price"=>"65.94", "cart_token"=>nil, "buyer_accepts_marketing"=>true, "name"=>"#9999", "referring_site"=>nil, "landing_site"=>nil, "cancelled_at"=>"2019-03-25T15:21:47-04:00", "cancel_reason"=>"customer", "total_price_usd"=>nil, "checkout_token"=>nil, "reference"=>nil, "user_id"=>nil, "location_id"=>nil, "source_identifier"=>nil, "source_url"=>nil, "processed_at"=>nil, "device_id"=>nil, "phone"=>nil, "customer_locale"=>"en", "app_id"=>nil, "browser_ip"=>nil, "landing_site_ref"=>nil, "order_number"=>1234, "discount_applications"=>[{"type"=>"manual", "value"=>"5.0", "value_type"=>"fixed_amount", "allocation_method"=>"one", "target_selection"=>"explicit", "target_type"=>"line_item", "description"=>"Discount", "title"=>"Discount"}], "discount_codes"=>[], "note_attributes"=>[], "payment_gateway_names"=>["visa", "bogus"], "processing_method"=>"", "checkout_id"=>nil, "source_name"=>"web", "fulfillment_status"=>"pending", "tax_lines"=>[], "tags"=>"", "contact_email"=>"jon@doe.ca", "order_status_url"=>"https://checkout.shopify.com/17004443/orders/123456abcd/authenticate?key=abcdefg", "presentment_currency"=>"USD", "total_line_items_price_set"=>{"shop_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}}, "total_discounts_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "total_shipping_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "subtotal_price_set"=>{"shop_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}}, "total_price_set"=>{"shop_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}}, "total_tax_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "total_tip_received"=>"0.0", "line_items"=>[{"id"=>866550311766439020, "variant_id"=>nil, "title"=>"Practice B-Range Golf Balls - 300 Count", "quantity"=>1, "price"=>"59.95", "sku"=>"CAS-MIX-BRANGE-REC-300-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1377072644139, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"Practice B-Range Golf Balls - 300 Count", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>14969, "total_discount"=>"0.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}, {"id"=>141249953214522974, "variant_id"=>nil, "title"=>"test 1890", "quantity"=>1, "price"=>"5.99", "sku"=>"CAS-MAR-314-PURPLE-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1680824926254, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"5 Martini 3 1/4\" Golf Tees", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>227, "total_discount"=>"5.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "discount_allocations"=>[{"amount"=>"5.00", "discount_application_index"=>0, "amount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}}], "tax_lines"=>[]}, {"id"=>141249953214522974, "variant_id"=>nil, "title"=>"test 3", "quantity"=>1, "price"=>"5.99", "sku"=>"CAS-MAR-314-PURPLE-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1680824926254, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"5 Martini 3 1/4\" Golf Tees", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>227, "total_discount"=>"5.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "discount_allocations"=>[{"amount"=>"5.00", "discount_application_index"=>0, "amount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}}], "tax_lines"=>[]}], "shipping_lines"=>[{"id"=>271878346596884015, "title"=>"Generic Shipping", "price"=>"10.00", "code"=>nil, "source"=>"shopify", "phone"=>nil, "requested_fulfillment_service_id"=>nil, "delivery_category"=>nil, "carrier_identifier"=>nil, "discounted_price"=>"10.00", "price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discounted_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}], "billing_address"=>{"first_name"=>"Bob", "address1"=>"123 Billing Street", "phone"=>"555-555-BILL", "city"=>"Billtown", "zip"=>"K2P0B0", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Biller", "address2"=>nil, "company"=>"My Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Bob Biller", "country_code"=>"US", "province_code"=>"KY"}, "shipping_address"=>{"first_name"=>"Steve", "address1"=>"123 Shipping Street", "phone"=>"555-555-SHIP", "city"=>"Shippington", "zip"=>"40003", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Shipper", "address2"=>nil, "company"=>"Shipping Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Steve Shipper", "country_code"=>"US", "province_code"=>"KY"}, "fulfillments"=>[], "refunds"=>[], "customer"=>{"id"=>115310627314723954, "email"=>"john@test.com", "accepts_marketing"=>false, "created_at"=>nil, "updated_at"=>nil, "first_name"=>"John", "last_name"=>"Smith", "orders_count"=>0, "state"=>"disabled", "total_spent"=>"0.00", "last_order_id"=>nil, "note"=>nil, "verified_email"=>true, "multipass_identifier"=>nil, "tax_exempt"=>false, "phone"=>nil, "tags"=>"", "last_order_name"=>nil, "currency"=>"USD", "accepts_marketing_updated_at"=>nil, "marketing_opt_in_level"=>nil, "default_address"=>{"id"=>715243470612851245, "customer_id"=>115310627314723954, "first_name"=>nil, "last_name"=>nil, "company"=>nil, "address1"=>"123 Elm St.", "address2"=>nil, "city"=>"Ottawa", "province"=>"Ontario", "country"=>"Canada", "zip"=>"K2H7A8", "phone"=>"123-123-1234", "name"=>"", "province_code"=>"ON", "country_code"=>"CA", "country_name"=>"Canada", "default"=>true}}, "controller"=>"email", "action"=>"save_order"}
      # params = {"id"=>820982911946154508, "email"=>"dustin@wittycreative.com", "closed_at"=>nil, "created_at"=>"2019-03-25T15:21:47-04:00", "updated_at"=>"2019-03-25T15:21:47-04:00", "number"=>234, "note"=>nil, "token"=>"123456abcd", "gateway"=>nil, "test"=>true, "total_price"=>"70.94", "subtotal_price"=>"60.94", "total_weight"=>0, "total_tax"=>"0.00", "taxes_included"=>false, "currency"=>"USD", "financial_status"=>"voided", "confirmed"=>false, "total_discounts"=>"5.00", "total_line_items_price"=>"65.94", "cart_token"=>nil, "buyer_accepts_marketing"=>true, "name"=>"#9999", "referring_site"=>nil, "landing_site"=>nil, "cancelled_at"=>"2019-03-25T15:21:47-04:00", "cancel_reason"=>"customer", "total_price_usd"=>nil, "checkout_token"=>nil, "reference"=>nil, "user_id"=>nil, "location_id"=>nil, "source_identifier"=>nil, "source_url"=>nil, "processed_at"=>nil, "device_id"=>nil, "phone"=>nil, "customer_locale"=>"en", "app_id"=>nil, "browser_ip"=>nil, "landing_site_ref"=>nil, "order_number"=>1234, "discount_applications"=>[{"type"=>"manual", "value"=>"5.0", "value_type"=>"fixed_amount", "allocation_method"=>"one", "target_selection"=>"explicit", "target_type"=>"line_item", "description"=>"Discount", "title"=>"Discount"}], "discount_codes"=>[], "note_attributes"=>[], "payment_gateway_names"=>["visa", "bogus"], "processing_method"=>"", "checkout_id"=>nil, "source_name"=>"web", "fulfillment_status"=>"pending", "tax_lines"=>[], "tags"=>"", "contact_email"=>"jon@doe.ca", "order_status_url"=>"https://checkout.shopify.com/17004443/orders/123456abcd/authenticate?key=abcdefg", "presentment_currency"=>"USD", "total_line_items_price_set"=>{"shop_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}}, "total_discounts_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "total_shipping_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "subtotal_price_set"=>{"shop_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}}, "total_price_set"=>{"shop_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}}, "total_tax_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "total_tip_received"=>"0.0", "line_items"=>[{"id"=>866550311766439020, "variant_id"=>nil, "title"=>"Practice B-Range Golf Balls - 300 Count", "quantity"=>1, "price"=>"59.95", "sku"=>"CAS-MIX-BRANGE-REC-300-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1377072644139, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"Practice B-Range Golf Balls - 300 Count", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>14969, "total_discount"=>"0.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}, {"id"=>141249953214522974, "variant_id"=>nil, "title"=>"test 4", "quantity"=>1, "price"=>"5.99", "sku"=>"CAS-MAR-314-PURPLE-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1680824926254, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"5 Martini 3 1/4\" Golf Tees", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>227, "total_discount"=>"5.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "discount_allocations"=>[{"amount"=>"5.00", "discount_application_index"=>0, "amount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}}], "tax_lines"=>[]}, {"id"=>141249953214522974, "variant_id"=>nil, "title"=>"test 29", "quantity"=>1, "price"=>"5.99", "sku"=>"CAS-MAR-314-PURPLE-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1377072644139, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"5 Martini 3 1/4\" Golf Tees", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>227, "total_discount"=>"5.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "discount_allocations"=>[{"amount"=>"5.00", "discount_application_index"=>0, "amount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}}], "tax_lines"=>[]}, {"id"=>141249953214522974, "variant_id"=>nil, "title"=>"test 131", "quantity"=>1, "price"=>"5.99", "sku"=>"CAS-MAR-314-PURPLE-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1680824926254, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"5 Martini 3 1/4\" Golf Balls", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>227, "total_discount"=>"5.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "discount_allocations"=>[{"amount"=>"5.00", "discount_application_index"=>0, "amount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}}], "tax_lines"=>[]}], "shipping_lines"=>[{"id"=>271878346596884015, "title"=>"Generic Shipping", "price"=>"10.00", "code"=>nil, "source"=>"shopify", "phone"=>nil, "requested_fulfillment_service_id"=>nil, "delivery_category"=>nil, "carrier_identifier"=>nil, "discounted_price"=>"10.00", "price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discounted_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}], "billing_address"=>{"first_name"=>"Bob", "address1"=>"123 Billing Street", "phone"=>"555-555-BILL", "city"=>"Billtown", "zip"=>"K2P0B0", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Biller", "address2"=>nil, "company"=>"My Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Bob Biller", "country_code"=>"US", "province_code"=>"KY"}, "shipping_address"=>{"first_name"=>"Steve", "address1"=>"123 Shipping Street", "phone"=>"555-555-SHIP", "city"=>"Shippington", "zip"=>"40003", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Shipper", "address2"=>nil, "company"=>"Shipping Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Steve Shipper", "country_code"=>"US", "province_code"=>"KY"}, "fulfillments"=>[], "refunds"=>[], "customer"=>{"id"=>115310627314723954, "email"=>"john@test.com", "accepts_marketing"=>false, "created_at"=>nil, "updated_at"=>nil, "first_name"=>"John", "last_name"=>"Smith", "orders_count"=>0, "state"=>"disabled", "total_spent"=>"0.00", "last_order_id"=>nil, "note"=>nil, "verified_email"=>true, "multipass_identifier"=>nil, "tax_exempt"=>false, "phone"=>nil, "tags"=>"", "last_order_name"=>nil, "currency"=>"USD", "accepts_marketing_updated_at"=>nil, "marketing_opt_in_level"=>nil, "default_address"=>{"id"=>715243470612851245, "customer_id"=>115310627314723954, "first_name"=>nil, "last_name"=>nil, "company"=>nil, "address1"=>"123 Elm St.", "address2"=>nil, "city"=>"Ottawa", "province"=>"Ontario", "country"=>"Canada", "zip"=>"K2H7A8", "phone"=>"123-123-1234", "name"=>"", "province_code"=>"ON", "country_code"=>"CA", "country_name"=>"Canada", "default"=>true}}, "controller"=>"email", "action"=>"save_order"}
      params = {"id"=>820982911946154508, "email"=>"dustin@wittycreative.com", "closed_at"=>nil, "created_at"=>"2019-03-25T15:21:47-04:00", "updated_at"=>"2019-03-25T15:21:47-04:00", "number"=>234, "note"=>nil, "token"=>"123456abcd", "gateway"=>nil, "test"=>true, "total_price"=>"70.94", "subtotal_price"=>"60.94", "total_weight"=>0, "total_tax"=>"0.00", "taxes_included"=>false, "currency"=>"USD", "financial_status"=>"voided", "confirmed"=>false, "total_discounts"=>"5.00", "total_line_items_price"=>"65.94", "cart_token"=>nil, "buyer_accepts_marketing"=>true, "name"=>"#9999", "referring_site"=>nil, "landing_site"=>nil, "cancelled_at"=>"2019-03-25T15:21:47-04:00", "cancel_reason"=>"customer", "total_price_usd"=>nil, "checkout_token"=>nil, "reference"=>nil, "user_id"=>nil, "location_id"=>nil, "source_identifier"=>nil, "source_url"=>nil, "processed_at"=>nil, "device_id"=>nil, "phone"=>nil, "customer_locale"=>"en", "app_id"=>nil, "browser_ip"=>nil, "landing_site_ref"=>nil, "order_number"=>1234, "discount_applications"=>[{"type"=>"manual", "value"=>"5.0", "value_type"=>"fixed_amount", "allocation_method"=>"one", "target_selection"=>"explicit", "target_type"=>"line_item", "description"=>"Discount", "title"=>"Discount"}], "discount_codes"=>[], "note_attributes"=>[], "payment_gateway_names"=>["visa", "bogus"], "processing_method"=>"", "checkout_id"=>nil, "source_name"=>"web", "fulfillment_status"=>"pending", "tax_lines"=>[], "tags"=>"", "contact_email"=>"jon@doe.ca", "order_status_url"=>"https://checkout.shopify.com/17004443/orders/123456abcd/authenticate?key=abcdefg", "presentment_currency"=>"USD", "total_line_items_price_set"=>{"shop_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"65.94", "currency_code"=>"USD"}}, "total_discounts_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "total_shipping_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "subtotal_price_set"=>{"shop_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"60.94", "currency_code"=>"USD"}}, "total_price_set"=>{"shop_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"70.94", "currency_code"=>"USD"}}, "total_tax_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "total_tip_received"=>"0.0", "line_items"=>[{"id"=>866550311766439020, "variant_id"=>nil, "title"=>"Practice B-Range Golf Balls - 300 Count", "quantity"=>1, "price"=>"59.95", "sku"=>"CAS-MIX-BRANGE-REC-300-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1680824926254, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"Practice B-Range Golf Balls - 300 Count", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>14969, "total_discount"=>"0.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"59.95", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"0.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}, {"id"=>141249953214522974, "variant_id"=>nil, "title"=>"test 4", "quantity"=>1, "price"=>"5.99", "sku"=>"CAS-MAR-314-PURPLE-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1680824926254, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"5 Martini 3 1/4\" Golf Tees", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>227, "total_discount"=>"5.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "discount_allocations"=>[{"amount"=>"5.00", "discount_application_index"=>0, "amount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}}], "tax_lines"=>[]}, {"id"=>141249953214522974, "variant_id"=>nil, "title"=>"test 29", "quantity"=>1, "price"=>"5.99", "sku"=>"CAS-MAR-314-PURPLE-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1680824926254, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"5 Martini 3 1/4\" Golf Tees", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>227, "total_discount"=>"5.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "discount_allocations"=>[{"amount"=>"5.00", "discount_application_index"=>0, "amount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}}], "tax_lines"=>[]}, {"id"=>141249953214522974, "variant_id"=>nil, "title"=>"test 131", "quantity"=>1, "price"=>"5.99", "sku"=>"CAS-MAR-314-PURPLE-CHILD", "variant_title"=>nil, "vendor"=>nil, "fulfillment_service"=>"manual", "product_id"=>1680824926254, "requires_shipping"=>true, "taxable"=>true, "gift_card"=>false, "name"=>"5 Martini 3 1/4\" Golf Balls", "variant_inventory_management"=>nil, "properties"=>[], "product_exists"=>true, "fulfillable_quantity"=>1, "grams"=>227, "total_discount"=>"5.00", "fulfillment_status"=>nil, "price_set"=>{"shop_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.99", "currency_code"=>"USD"}}, "total_discount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}, "discount_allocations"=>[{"amount"=>"5.00", "discount_application_index"=>0, "amount_set"=>{"shop_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"5.00", "currency_code"=>"USD"}}}], "tax_lines"=>[]}], "shipping_lines"=>[{"id"=>271878346596884015, "title"=>"Generic Shipping", "price"=>"10.00", "code"=>nil, "source"=>"shopify", "phone"=>nil, "requested_fulfillment_service_id"=>nil, "delivery_category"=>nil, "carrier_identifier"=>nil, "discounted_price"=>"10.00", "price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discounted_price_set"=>{"shop_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}, "presentment_money"=>{"amount"=>"10.00", "currency_code"=>"USD"}}, "discount_allocations"=>[], "tax_lines"=>[]}], "billing_address"=>{"first_name"=>"Bob", "address1"=>"123 Billing Street", "phone"=>"555-555-BILL", "city"=>"Billtown", "zip"=>"K2P0B0", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Biller", "address2"=>nil, "company"=>"My Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Bob Biller", "country_code"=>"US", "province_code"=>"KY"}, "shipping_address"=>{"first_name"=>"Steve", "address1"=>"123 Shipping Street", "phone"=>"555-555-SHIP", "city"=>"Shippington", "zip"=>"40003", "province"=>"Kentucky", "country"=>"United States", "last_name"=>"Shipper", "address2"=>nil, "company"=>"Shipping Company", "latitude"=>nil, "longitude"=>nil, "name"=>"Steve Shipper", "country_code"=>"US", "province_code"=>"KY"}, "fulfillments"=>[], "refunds"=>[], "customer"=>{"id"=>115310627314723954, "email"=>"john@test.com", "accepts_marketing"=>false, "created_at"=>nil, "updated_at"=>nil, "first_name"=>"John", "last_name"=>"Smith", "orders_count"=>0, "state"=>"disabled", "total_spent"=>"0.00", "last_order_id"=>nil, "note"=>nil, "verified_email"=>true, "multipass_identifier"=>nil, "tax_exempt"=>false, "phone"=>nil, "tags"=>"", "last_order_name"=>nil, "currency"=>"USD", "accepts_marketing_updated_at"=>nil, "marketing_opt_in_level"=>nil, "default_address"=>{"id"=>715243470612851245, "customer_id"=>115310627314723954, "first_name"=>nil, "last_name"=>nil, "company"=>nil, "address1"=>"123 Elm St.", "address2"=>nil, "city"=>"Ottawa", "province"=>"Ontario", "country"=>"Canada", "zip"=>"K2H7A8", "phone"=>"123-123-1234", "name"=>"", "province_code"=>"ON", "country_code"=>"CA", "country_name"=>"Canada", "default"=>true}}, "controller"=>"email", "action"=>"save_order"}

      order = Order.new
      order.email = params["email"]
      order.name = params["customer"]["first_name"]
      order.number = params["number"]
      order.line_items = params["line_items"]
    end

    ################
    # trigger email 
    ################

    FollowUpMailer.replenishment(order).deliver

  end

  def self.review_email(order)
    puts "review_email"


  end

  private

    def self.http_request(url, body = nil, type = nil)
      if type == "delete"
        request = Net::HTTP::Delete.new(url)
      elsif type == "post"
        request = Net::HTTP::Post.new(url)
      elsif type == "get"
        request = Net::HTTP::Get.new(url)
      elsif type == "patch"
        request = Net::HTTP::Patch.new(url)
      elsif type == "put"
        request = Net::HTTP::Put.new(url)
      else
        request = Net::HTTP::Get.new(url)
      end
      request.basic_auth("anystring", ENV['MAILCHIMP_KEY'])

      if body
        request.body = body.to_json
      end

      req_options = {
        use_ssl: url.scheme == "https",
      }

      response = Net::HTTP.start(url.hostname, url.port, req_options) do |http|
        http.request(request)
      end

      puts Colorize.yellow(request)
      puts Colorize.yellow(response.code)
      if response.code == "400"
        puts Colorize.red(response.read_body)
      end

      unless response.code == "204"
        JSON.parse response.read_body
      end
    end

end
































